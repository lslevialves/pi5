
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Formas de Pessoas</title>
</h:head>
<h:body>
	<h:form id="form">
	
		<p:growl id="msgs" showDetail="true" />
		
		<div align="right">
			<h:commandLink>
				<p:graphicImage value="/publico/imagens/excel.png" width="24"/>
				<p:dataExporter type="xls" target="tbl" fileName="f" />
			</h:commandLink>
			
			<h:commandLink>
				<p:graphicImage value="/public/images/pdf.png" width ="24"/>
				<p:dataExporter type ="pdf" target= "tbl" fileName="f"/>
			</h:commandLink>
			
			<h:commandLink>
				<p:graphicImage value="/public/imagens/csv.png" width= "24"/>
				<p:dataExporter type="csv" target="tbl" fileName="f" />			
			</h:commandLink>
		
			<h:commandLink>
				<p:graphicImage value="/publico/imagens/xml.png" width="24" />
				<p:dataExporter type="xml" target="tbl" fileName="f"/>
			</h:commandLink>
		</div>
		
					<p:dataTable id="tbl" var ="f" value="#{pessoaCtrl.listagem}"
					paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink}
					{PageLinks} {NextPageLink} {LastPageLink}"
					paginator="true" rows="10" style="margin-bottom:20px"> 
					
			<f:facet name="header">
				<h:outputLabel value="Listagem de pessoa"/>
				<p:commandButton value="Inserir" icon="icon-novo"
					actionListener="#{pessoaCtrl.actionInserir}"
					oncomplete="PF('cadDialog').show()"
					update=":form:cadDetail">
				</p:commandButton>
			</f:facet>	
				
			<p:column headerText= "Nome das pessoas." sortBy="f.nome">
				<h:outputText value="#{f.nome}" />
			</p:column>
			<p:column headerText="CPF" sortBy="f.cpf">
				<h:outputText value="#{f.cpf}"/> 
			</p:column>
			
			<p:column style="width:32px;text-align: center">
				<p:commandButton update=":form:cadDetail" oncomplete="PF('cadDialog').show()"
				icon="ui-icon-search" title="View">
				<f:setPropertyActionListener value="#{f}" target="#{pessoaCtrl.pessoa}"/>
				</p:commandButton>
			</p:column>			
		</p:dataTable>
			
		<p:dialog header="Cadastro de Pessoas" widgetVar="cadDialog" modal="true"
					showEffect="fade" hideEffect="fade" resizable="false">
			<p:outputPanel id="cadDetail" style="text-align: center;" >
			<h:panelGrid columns="2" style="text-align: left">
				<h:outputLabel value="Código" />
				<p:inputText value="#{pessoaCtrl.pessoa.id}" size="15" maxlength="10" readonly="true" />
				<h:outputLabel value="Endereço rua"/>
				<p:inputText value="#{pessoaCtrl.pessoa.rua}" size="15" maxlength="25"/>
				<h:outputLabel value="Endereço cep"/>
				<p:inputText value="#{pessoaCtrl.pessoa.cep}" size="15" maxlength="15"/>
				<h:outputLabel value="Nome"/>
				<p:inputText value="#{pessoaCtrl.pessoa.nome}" size="15" maxlength="30"/>
				<h:outputLabel value="Endereço bairro"/>
				<p:inputText value="#{pessoaCtrl.pessoa.bairro}" size="15" maxlength="10"/>
				<h:outputLabel value="RG"/>
				<p:inputText value="#{pessoaCtrl.pessoa.rg}" size="15" maxlength="10"/>
				<h:outputLabel value="CPF"/>
				<p:inputText value="#{pessoaCtrl.pessoa.cpf}" size="15" maxlength="15"/>
				<h:outputLabel value="cidade"/>
				<p:inputText value="#{pessoaCtrl.pessoa.cidade}" size="15" maxlength="25"/>
				<h:outputLabel value="senha"/>
				<p:inputText value="#{pessoaCtrl.pessoa.senha}" size="15" maxlength="3"/>
				<h:outputLabel value="tipo"/>
				<p:inputText value="#{pessoaCtrl.pessoa.tipo}" size="15" maxlength="20"/>
				<h:outputLabel value="Email"/>
				<p:inputText value="#{pessoaCtrl.pessoa.email}" size="15" maxlength="20"/>
				<h:outputLabel value="estado"/>
				<p:inputText value="#{pessoaCtrl.pessoa.uf}" size="15" maxlength="15"/>
				<h:outputLabel value="Data de Nascimento"/>
				<p:inputText value="#{pessoaCtrl.pessoa.data_nasc}" size="20" maxlength="15">
				<f:convertDateTime dateStyle="short"/>
				</p:inputText>
				</h:panelGrid>
			    <h:panelGrid columns="3" style="text-align: left">
				<h:commandButton oncomplete="cadDialog.hide()" value="Cancelar" />
				<h:commandButton action="#{pessoaCtrl.actionExcluir}" update="growl" value="Excluir" />
				<h:commandButton action="#{pessoaCtrl.actionGravar}" update="growl" value="Gravar" />
				</h:panelGrid>
				<h:dataTable value ="#{pessoaCtrl.pessoa.fones}" var = "fone" rules = "rows">
				<f:facet name = "header">
					<p:commandButton value="Adicionar Fone" actionListener= "#{pessoaCtrl.actionInserirFone}" update =":form:cadDetail" />
				</f:facet>
				<h:column>
						<f:facet name="header"><h:outputLabel value = "Numero"/></f:facet>				
						<h:inputText value="#{fone.numero}" size ="20" maxlength = "30" />
					</h:column>
					<h:column>
						<f:facet name="header"><h:outputLabel value = "Descrição"/></f:facet>				
						<h:inputText value="#{fone.descricao}" size ="20" maxlength = "30" />
					</h:column>
					<h:column>
						<p:commandLink  value="Excluir"  actionListener= "#{pessoaCtrl.actionExcluirFone(fones)}" update =":form:cadDetail"/>					
					</h:column>
				</h:dataTable>
			
			<p:commandButton value="Gravar" action="#{pessoaCtrl.actionGravar()}"/>
		
		</p:outputPanel>
	</p:dialog>
	
	</h:form>
</h:body>

</html>